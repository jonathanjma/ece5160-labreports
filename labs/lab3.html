<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Lab 3 | ECE 5160 Fast Robots Labs </title> <meta name="author" content="Jonathan Ma"> <meta name="description" content="Time of Flight (ToF)"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/ece5160-labreports/assets/css/bootstrap.min.css?v=a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/ece5160-labreports/assets/css/academicons.min.css?v=f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/ece5160-labreports/assets/css/scholar-icons.css?v=62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/ece5160-labreports/assets/css/jekyll-pygments-themes-github.css?v=591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A4%96&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/ece5160-labreports/assets/css/main.css?v=d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jonathanjma.github.io/ece5160-labreports/labs/lab3.html"> <script src="/ece5160-labreports/assets/js/theme.js?v=48c9b5bd7f2e0605e39e579400e22553"></script> <link defer rel="stylesheet" href="/ece5160-labreports/assets/css/jekyll-pygments-themes-native.css?v=5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/ece5160-labreports/"> ECE 5160 Fast Robots Labs </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/ece5160-labreports/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/ece5160-labreports/labs/">labs <span class="sr-only">(current)</span> </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="fa-solid fa-magnifying-glass"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-half-sun-moon" id="light-toggle-system"></i> <i class="fa-solid fa-moon" id="light-toggle-dark"></i> <i class="fa-solid fa-sun" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Lab 3</h1> <p class="post-description">Time of Flight (ToF)</p> </header> <article> <h3 id="setup">Setup</h3> <p>For the car, I was given 2 ToF sensors. I decided it would be best to put one sensor at the front of the car and one on the right side of the car in order to maximize the coverage of obstacles. So to see obstacles on the back and left of the car, we would have to rotate the car. For the wiring, I decided to use the 2 longer QWIIC connect wires for the ToF sensors since they were more position sensitive than the IMU or the QWIIC breakout board (which will use the short wires). Below is a wiring diagram showing how the all the sensors will be connected. Since we have 2 ToF sensors which will both have the same default I2C address, we will connect one of the ToF’s XSHUT inputs to the Artemis’ GPIO pin. This allows us programmatically turn off one of the ToF sensors when the Artemis starts up so that we can change the other sensor’s default I2C address.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/ece5160-labreports/assets/img/lab3/wiring-480.webp 480w,/ece5160-labreports/assets/img/lab3/wiring-800.webp 800w,/ece5160-labreports/assets/img/lab3/wiring-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/ece5160-labreports/assets/img/lab3/wiring.png" class="img-fluid rounded z-depth-1" width="60%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This lab involved a considerate amount of soldering, and the photos below shows the battery soldered with its new JST connector and one of ToFs soldered to its input signal and power wires.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/ece5160-labreports/assets/img/lab3/battery_soldered-480.webp 480w,/ece5160-labreports/assets/img/lab3/battery_soldered-800.webp 800w,/ece5160-labreports/assets/img/lab3/battery_soldered-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/ece5160-labreports/assets/img/lab3/battery_soldered.jpeg" class="img-fluid rounded z-depth-1" width="60%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/ece5160-labreports/assets/img/lab3/tof_soldered-480.webp 480w,/ece5160-labreports/assets/img/lab3/tof_soldered-800.webp 800w,/ece5160-labreports/assets/img/lab3/tof_soldered-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/ece5160-labreports/assets/img/lab3/tof_soldered.jpeg" class="img-fluid rounded z-depth-1" width="60%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="lab">Lab</h3> <p>I first started off by running the example program under <code class="language-plaintext highlighter-rouge">File-&gt;Examples-&gt;Apollo3-&gt;Example05_Wire_I2C</code> to verify the I2C address of the ToF sensor. As shown in the image below, the program prints an address of 0x29, which is different than the 0x52 address specified by the datasheet. But upon further analysis, the datasheet says the LSB of the address is the read/write bit, and 0x29 is just 0x52 shifted right a bit, so this makes sense.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/ece5160-labreports/assets/img/lab3/address-480.webp 480w,/ece5160-labreports/assets/img/lab3/address-800.webp 800w,/ece5160-labreports/assets/img/lab3/address-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/ece5160-labreports/assets/img/lab3/address.png" class="img-fluid rounded z-depth-1" width="60%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Comparing the short, medium, and long distance modes, we see that each mode has its own pros and cons. As seen in the images from the datasheet below, the short mode sees the shortest distance, but also performs the best under strong ambient light. It also allows for 20ms sensor readings, which allows for fast loop times. Medium mode doubles the distance compared to short mode, and long mode triples the distance. However, these modes require longer sensor readings and under strong ambient light they perform worse than short mode. Ultimately, I choose short mode since the fast measurements are crucial for the car and most obstacles should be within 1.3 meters.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/ece5160-labreports/assets/img/lab3/distance_stats-480.webp 480w,/ece5160-labreports/assets/img/lab3/distance_stats-800.webp 800w,/ece5160-labreports/assets/img/lab3/distance_stats-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/ece5160-labreports/assets/img/lab3/distance_stats.png" class="img-fluid rounded z-depth-1" width="60%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/ece5160-labreports/assets/img/lab3/timing_stats-480.webp 480w,/ece5160-labreports/assets/img/lab3/timing_stats-800.webp 800w,/ece5160-labreports/assets/img/lab3/timing_stats-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/ece5160-labreports/assets/img/lab3/timing_stats.png" class="img-fluid rounded z-depth-1" width="60%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>To test the ToF sensor’s accuracy, repeatability, and ranging time, I used the following setup where I taped the sensor to the back of my laptop I measured the distance between it and a wall with a ruler.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/ece5160-labreports/assets/img/lab3/test_setup-480.webp 480w,/ece5160-labreports/assets/img/lab3/test_setup-800.webp 800w,/ece5160-labreports/assets/img/lab3/test_setup-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/ece5160-labreports/assets/img/lab3/test_setup.jpeg" class="img-fluid rounded z-depth-1" width="60%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The graph below shows the sensor’s distance measurements compared to a ruler. This shows that the distance measurements almost exactly match the ruler, even past the 1300mm max distance stated by the datasheet.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/ece5160-labreports/assets/img/lab3/accuracy-480.webp 480w,/ece5160-labreports/assets/img/lab3/accuracy-800.webp 800w,/ece5160-labreports/assets/img/lab3/accuracy-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/ece5160-labreports/assets/img/lab3/accuracy.png" class="img-fluid rounded z-depth-1" width="60%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>For repeatability, I did 3 sets of measuremenst where I had the sensor collect 32 samples at 3 different distances.</p> <ul> <li>At 300mm, the standard devitation was 0.83mm</li> <li>At 600mm, the standard devitation was 1.13mm</li> <li>At 900mm, the standard devitation was 1.18mm</li> </ul> <p>This shows that as the distance increases, the repeatability decreases slightly. And for ranging time, using the example code I get a ranging time of 50ms for all distances below 135cm. Above 135cm, the ranging time is 30ms, but that is probably because the sensor is just estimating the distance.</p> <h3 id="5000-level-tasks">5000 Level Tasks</h3> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2026 Jonathan Ma. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://github.com/jonathanjma/ece5160-labreports" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/ece5160-labreports/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/ece5160-labreports/assets/js/masonry.js?v=a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/ece5160-labreports/assets/js/zoom.js?v=85ddb88934d28b74e78031fd54cf8308"></script> <script src="/ece5160-labreports/assets/js/no_defer.js?v=2781658a0a2b13ed609542042a859126"></script> <script defer src="/ece5160-labreports/assets/js/common.js?v=c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/ece5160-labreports/assets/js/copy_code.js?v=c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/ece5160-labreports/assets/js/jupyter_new_tab.js?v=d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/ece5160-labreports/assets/js/mathjax-setup.js?v=a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/ece5160-labreports/assets/js/progress-bar.js?v=2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/ece5160-labreports/assets/js/vanilla-back-to-top.min.js?v=f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/ece5160-labreports/assets/js/search/ninja-keys.min.js?v=a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/ece5160-labreports/assets/js/search-setup.js?v=6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/ece5160-labreports/assets/js/search-data.js"></script> <script src="/ece5160-labreports/assets/js/shortcut-key.js?v=ccc841c459bfc0e64c1c2b5acd10df02"></script> </body> </html>